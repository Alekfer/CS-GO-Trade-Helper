function populateDetails(t,e){function s(){if($(this).attr("id")&&!$(this).data("st-loaded-floats")){var e=$(this).attr("id").split("730_2_")[1];if(!inventories.details[t][e])return $(this).data("st-float",-1);var s=inventories.details[t][e].float;$(this).data("st-float",s),inventories.details[t][e].phase&&(s+=" "+inventories.details[t][e].phase),inventories.details[t][e].seed&&inventories.infoPairs[t][e]&&(s+=formatPattern(inventories.infoPairs[t][e].name,inventories.details[t][e].seed)),$(this).find(".slot_app_fraudwarning").css("margin-top","15px"),$(this).append('<span style="font-size: '+settings.fontsizetop+'px" class="st-item-float">'+s+"</span>"),$(this).data("st-loaded-floats",!0)}}if(!inventories.infoPairs.hasOwnProperty(t))return setTimeout(populateDetails.bind(null,t,e),750);var i="#"+(e?"your_slots":"their_slots");!$(i).data("st-loaded-floats")&&$(i+" .item.app730.context2:not(.pendingItem)").length>0&&0==$(i+".item.unknownItem").length&&($(i+" .item.app730.context2:not(.pendingItem)").each(s),$(i).data("st-loaded-floats",!0)),whenInventoryLoads(t,(function(){if(0==Object.keys(inventories.infoPairs[t]).length)return setTimeout(populateDetails.bind(null,t,e),100);$(".item.app730.context2:not(.pendingItem)").each(s),$(".st-item-float").hide().fadeIn()}))}function sortItems(t,e){var s=$(t).find(".item.app730.context2:not(.pendingItem)").eq(0).data(sort.byPrice?"st-price":"st-float"),i=$(e).find(".item.app730.context2:not(.pendingItem)").eq(0).data(sort.byPrice?"st-price":"st-float");return s==-1&&(s=sort.asc?1:0),i==-1&&(i=sort.asc?1:0),sort.asc?s-i:i-s}function loadPricesFor(t,e){function s(){var s=$(this).attr("id").split("730_2_")[1],i=inventories.itemsInTrade[e?"me":t].indexOf(s)>-1;!$(this).parent().hasClass("slot_inner")&&i&&$(this).css("background-color","hsla("+settings.intradebg+", 35%, 21%, 0.74902)");var n=inventories.infoPairs[t][s];if(!n)return console.log("item glitched",t,n);$(this).data("st-price",Number(n.price)||0),$(this).data("st-type",n.type),n.price?$(this).append('<span style="font-size: '+settings.fontsizebottom+'px" class="st-item-price">'+formatPrice(n.price)+"</span>"):($(this).append('<div class="st-item-no-price" style="box-shadow: 0px 0px black"></div>'),["rgb(210, 210, 210)","rgb(134, 80, 172)"].indexOf($(this).css("border-color"))>-1&&$(this).css("border-color","red")),$(this).append('<span style="font-size: '+settings.fontsizebottom+'px" class="st-item-wear">'+n.wear+"</span>");for(var a=0;a<n.stickers.length;a++)$(this).append('<img class="st-item-sticker" src="'+n.stickers[a]+'" style="margin-left: '+25*a+'%">')}2==Object.keys(inventories.infoPairs).length&&"Loading prices..."==$("#st-load-prices").text()&&($("#st-load-prices").text("Successfully loaded prices!"),$("#nonresponsivetrade_itemfilters").before('<br><br><a id="st-take-all" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn"><span>Take All</span></a><a id="st-take-keys" style="margin-left:10px" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn"><span>Take Keys</span></a><div class="st-trade-offer-input"><input class="filter_search_box" type="text" id="st-key-count" value="" placeholder="# of Keys" name="filter" autocomplete="off" onkeypress="return event.charCode >= 48 && event.charCode <= 57"></div>'),$("#st-take-all").click((function(){$(".inventory_page").each((function(){"none"!==$(this).css("display")&&"none"!==$(this).parent().css("display")&&$(this).find(".item.app730.context2:not(.pendingItem)").each((function(){"none"!==$(this).parent().css("display")&&addItemToTrade($(this).attr("id"))}))}))})),$("#st-take-keys").click((function(){var t=$("#st-key-count").val();!isNaN(t)&&t||(t=-1),$(".inventory_page").each((function(){if(!(t==-1&&"none"===$(this).css("display")||"none"===$(this).parent().css("display")||t!=-1&&"none"===$(this).parent().css("display"))){var e=$(this).parent().attr("id").split("_")[1];$(this).find(".item.app730.context2:not(.pendingItem)").each((function(){var s=$(this).attr("id");"Key"===inventories.infoPairs[e][s.split("_")[2]].type&&(t==-1||t>0)&&("none"!==$(this).parent().css("display")&&addItemToTrade(s),t!=-1&&t--)}))}}))})),$("#st-sort-price").click((function(){sort.byPrice=!0,$("#your_slots .itemHolder.has_item").sort(sortItems).prependTo("#your_slots"),$("#their_slots .itemHolder.has_item").sort(sortItems).prependTo("#their_slots"),sort.asc=!sort.asc})),$("#st-sort-float").click((function(){sort.byPrice=!1,$("#your_slots .itemHolder.has_item").sort(sortItems).prependTo("#your_slots"),$("#their_slots .itemHolder.has_item").sort(sortItems).prependTo("#their_slots"),sort.asc=!sort.asc})));var i="#"+(e?"your_slots":"their_slots");!$(i).data("st-loaded-prices")&&$(i+" .item.app730.context2:not(.pendingItem)").length>0&&0==$(i+".item.unknownItem").length&&($(i+" .item.app730.context2:not(.pendingItem)").each(s),$(i).data("st-loaded-prices",!0)),"block"==$("#inventory_"+t+"_730_2").css("display")?($("#inventory_"+t+"_730_2 .item.app730.context2:not(.pendingItem)").each(s),editActionMenu(!0,t),$(".st-trade-offer-prices, .st-item-price, .st-item-no-price, .st-item-float").hide().fadeIn()):setTimeout((function(){loadPricesFor(t,e)}),750)}function whenInventoryLoads(t,e){injectScriptWithEvent({"%%steamID%%":t},(function(){var t=setInterval((function(){"%%steamID%%"!=g_ActiveInventory.owner.strSteamId||g_ActiveInventory.BIsPendingInventory()||(window.dispatchEvent(new CustomEvent("%%event%%",{detail:!0})),clearInterval(t))}),150)}),e)}function getInventoryFromOffer(t,e){injectScriptWithEvent({"%%who%%":t,"%%who1%%":t},(function(){var t=setInterval((function(){var e=UserThem;if(null!==e.getInventory(730,2).rgInventory){clearInterval(t);var s={},i=e.getInventory(730,2).rgInventory;for(var n in i)s[n]=jQuery.extend({},i[n]),s[n].element=s[n].homeElement=void 0;window.dispatchEvent(new CustomEvent("%%event%%",{detail:{inventory:s,steamID:UserThem.strSteamId}}))}}),50)}),e)}$("#nonresponsivetrade_itemfilters").before('<div class="trade_rule selectableNone trade_responsive_hidden"></div><span id="st-load-prices" style="margin-left:0" class="st-log-msg">Loading prices...</span><br><span id="st-load-my-floats" style="margin-left:0" class="st-log-msg">Loading my floats: attempt #0</span><br><span id="st-load-partner-floats" style="margin-left:0" class="st-log-msg">Loading partner floats: attempt #0</span>'),$("#trade_area").before('<div class="st-trade-offer-box"><a id="st-sort-price" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn"><span>Sort by Price</span></a><a style="margin-left:10px" id="st-sort-float" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn"><span>Sort by Float</span></a></div>'),$("#trade_yours .offerheader").after('<div class="st-trade-offer-totals"><span id="st-my-price">'+formatPrice(0)+'</span><span id="st-my-items" class="st-display-right">0 items</span><span style="font-size: 16px" id="st-my-types"></span></div>'),$("#trade_theirs .offerheader").after('<div class="st-trade-offer-totals"><span id="st-their-price">'+formatPrice(0)+'</span><span id="st-their-items" class="st-display-right">0 items</span><span style="font-size: 16px" id="st-their-types"></span></div>'),setInterval((function(){var t={mine:{items:0,price:0,types:{}},theirs:{items:0,price:0,types:{}}};$("#your_slots .item.app730.context2:not(.pendingItem)").each((function(){t.mine.items+=1,$(this).data("st-price")&&(t.mine.price+=$(this).data("st-price")),$(this).data("st-type")&&(t.mine.types[$(this).data("st-type")]?t.mine.types[$(this).data("st-type")]+=1:t.mine.types[$(this).data("st-type")]=1)})),$("#st-my-types").html(buildItemSummary(t.mine.types,!0)),$("#st-my-price").text(formatPrice(t.mine.price)),$("#st-my-items").text(t.mine.items+(1==t.mine.items?" item":" items")),$("#their_slots .item.app730.context2:not(.pendingItem)").each((function(){t.theirs.items+=1,$(this).data("st-price")&&(t.theirs.price+=$(this).data("st-price")),$(this).data("st-type")&&(t.theirs.types[$(this).data("st-type")]?t.theirs.types[$(this).data("st-type")]+=1:t.theirs.types[$(this).data("st-type")]=1)})),$("#st-their-types").html(buildItemSummary(t.theirs.types,!0)),$("#st-their-price").text(formatPrice(t.theirs.price)),$("#st-their-items").text(t.theirs.items+(1==t.theirs.items?" item":" items"))}),350);var inventories={infoPairs:{},details:{},itemsInTrade:{},errorLoadingInv:{}};[!0,!1].forEach((function(t){getSteamID(t,(function(e){chrome.runtime.sendMessage({action:"getTradeItems",steamID:t?"me":e},(function(s){inventories.itemsInTrade[t?"me":e]=s.items})),getInventoryFromOffer(t?"You":"Them",(function(s){parseInventory(s.steamID,replicateSteamResponse(s),(function(i,n){inventories.infoPairs[s.steamID]=i,loadPricesFor(e,t)}))})),getInventoryDetails(e,(function(s,i){if(!s)return $("#st-load-"+(t?"my":"partner")+"-floats").text("Loading "+(t?"my":"partner")+" floats: attempt #"+i);$("#st-load-"+(t?"my":"partner")+"-floats").text("Loaded "+(t?"my":"partner")+" floats successfully..."),inventories.details[e]=s,populateDetails(e,t)}),0)}),!0)}));var sort={asc:!1,byPrice:!0};injectScriptWithEvent({},stickerPriceInjection,stickerPriceCallback);