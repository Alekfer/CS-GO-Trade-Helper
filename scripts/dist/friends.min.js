$(".maincontent").prepend('<div class="gray_bevel for_text_input" style="width:500px"><input id="st-search-name" style="width:500px" placeholder="Which item are you looking for?"></div><a id="st-search-start" class="btn_darkblue_white_innerfade btn_medium btn_disabled" style="margin-left:10px"><span>Search</span></a><a id="st-search-load" class="btn_green_white_innerfade btn_medium" style="margin-left:10px"><span id="st-loaded">Load Inventories</span></a><div id="st-display"></div>');var inventories={},profiles={},steamids=[],totalFriends=$(".friendBlock").length;$("#st-search-load").click((function(){function e(t){getInventory(steamids[t],(function(i,a,s){inventories[steamids[t]]=a,t+1<steamids.length&&e(t+1),$("#st-loaded").text("Loading: "+Object.keys(inventories).length+" / "+totalFriends)}))}$(this).data("st-loading")||($(this).data("st-loading",!0),$("#st-search-start").removeClass("btn_disabled"),$("#st-search-load").addClass("btn_disabled"),$("#st-loaded").text("Loading: 0 / "+totalFriends),$(".friendBlock").each((function(){var e=toSteam64($(this).data("miniprofile"));steamids.push(e),profiles[e]=$(this).find(".playerAvatar").css("display","inline-block")[0].outerHTML})),steamids.length>0&&e(0))})),$("#st-search-start").click((function(){var e=$("#st-search-name").val().replace(/[|() -$-\/:-?{-~!"^_`\[\]\\'.£%^@&*+,|0-9]/g,"").toLowerCase(),t={};for(var i in inventories)for(var a in inventories[i]){var a=inventories[i][a];a.name.replace(/[|() -$-\/:-?{-~!"^_`\[\]\\'.£%^@&*+,|0-9]/g,"").toLowerCase().indexOf(e)!=-1&&(t.hasOwnProperty(i)?t[i].push(a):t[i]=[a])}$("#st-display").html("");for(var s in t){var r={};t[s].forEach((function(e){"Key"==e.type&&(r[e.name]=(r[e.name]||0)+1)})),t[s].sort((function(e,t){return isNaN(e.price)&&(e.price=0),isNaN(t.price)&&(t.price=0),t.price-e.price}));var n=[];t[s].forEach((function(e){"Key"!=e.type&&(n+='<a class="hoverunderline" href="http://steamcommunity.com/profiles/'+s+"/inventory/#730_2_"+e.id+'" style="margin-right: 5px; color:#'+e.color+'">'+e.name+" ("+e.wear+")"+(e.price?" - "+formatPrice(e.price):"")+"</a><br>")}));for(var o in r)n+='<a class="hoverunderline" href="http://steamcommunity.com/profiles/'+s+'/inventory/" style="margin-right: 5px; color:#D2D2D2">'+o+" x "+r[o]+"<br></a>";$("#st-display").append('<div class="st-search-profile"><a href="http://steamcommunity.com/profiles/'+s+'">'+profiles[s]+'</a><div class="st-search-item-list">'+n+"</div></div>")}}));