function formatPrice(e){return settings.exchangesymb+(Number(e)*rates[settings.exchangeabbr]).toFixed(2)}function getAPIKey(e){chrome.runtime.sendMessage({action:"getAPIKey"},(function(t){e(t.data)}))}function buildItemSummary(e,t){if(0==Object.keys(e).length)return"";var n="<hr "+(t?'style="margin-bottom:-2px" ':"")+'class="st-trade-offer-divider">',i=[];for(var r in e)i.push(r+": "+e[r]);return n+i.join(t?", ":"<br>")}function checkVerification(e,t){$.ajax({url:"https://i7xx.xyz/api/1/verified",data:{steamid:e},success:t})}function getInventory(e,t,n){if(arguments.length<3&&(n=0),console.log("Loading inventory JSON for "+e+", attempt #"+(n+1)),++n>3)return void("function"==typeof t&&t(!0,null,null));$.ajax({url:"https://steamcommunity.com/profiles/"+e+"/inventory/json/730/2",success:function(n,i,r){if(!n.success)return void("function"==typeof t&&t(!0,null,null));parseInventory(e,n,(function(e,n){"function"==typeof t&&t(!1,e,n)}))},error:function(i){setTimeout(getInventory.bind(null,e,t,n),2e3)}})}function parseInventory(e,t,n){if(0==Object.keys(prices).length)return setTimeout(parseInventory.bind(null,e,t,n),500);for(var i in t.rgDescriptions){var r=t.rgDescriptions[i];if(r&&r.market_hash_name){var a="V",o="Unknown";r.hasOwnProperty("tags")?r.tags.forEach((function(e){"Exterior"==e.category&&(e.localized_tag_name&&(a=e.localized_tag_name.replace(/[-a-z ]/g,"")),e.name&&(a=e.name.replace(/[-a-z ]/g,""))),"Type"==e.category&&(e.localized_tag_name&&(o=e.localized_tag_name),e.name&&(o=e.name))})):(r.hasOwnProperty("type")&&(o=r.type),r.descriptions.forEach((function(e){e.value.indexOf("Exterior")>-1&&(a=e.value.split(" ")[1].replace(/[-a-z ]/g,""))}))),"NP"===a&&(a="V");var s=getStickersFromDescriptions(r.descriptions);idPairs[r.classid+"_"+r.instanceid]={name:r.name.replace("StatTrak™ ",""),price:Number(prices[r.market_hash_name]),wear:a,color:r.name_color,tradable:r.tradable,img:r.icon_url,type:o,stickers:s,inspect:r.actions&&1==r.actions.length?r.actions[0].link.replace("%owner_steamid%",e):null}}}var c={};for(var i in t.rgInventory){var r=t.rgInventory[i];if(r&&r.id){idPairs[r.classid+"_"+r.instanceid].id=r.id;var l=idPairs[r.classid+"_"+r.instanceid].inspect;l&&(idPairs[r.classid+"_"+r.instanceid].inspect=l.replace("%assetid%",r.id)),c[r.id]=idPairs[r.classid+"_"+r.instanceid]}}n(c,idPairs)}function getStickersFromDescriptions(e){var t=[];return e.forEach((function(e){e.value.indexOf("Sticker Details")!=-1&&$(e.value).find("img").each((function(){t.push($(this).attr("src"))}))})),t}function formatPattern(e,t){return e=e.replace("StatTrak™ ","").replace("StatTrak™ ",""),patterns[e]&&patterns[e][t]?e.indexOf("Case Hardened")==-1?" "+patterns[e][t]+"%":(e.indexOf("AK-47")==-1&&e.indexOf("Five-SeveN")==-1?"<br>":" ")+patterns[e][t]:""}function isOfferGlitched(e,t){makeAPICall("https://api.steampowered.com/IEconService/GetTradeOffer/v1/",{language:"",tradeofferid:e},(function(e){if(e.err)return t(!1);if(!e.descriptions)return t(!0);var n=e.descriptions.map((function(e){return e.classid}));t(e.offer.items_to_give.concat(e.offer.items_to_receive).some((function(e){if(n.indexOf(e.classid)==-1)return!0})))}))}function getInventoryDetails(e,t,n){$.ajax({url:"//csgo.exchange/inventoryapi/1/"+e,success:function(i){if(!i||i.error||!i.steamid||!i.inventory)return t(null,n+1),setTimeout((function(){getInventoryDetails(e,t,n+1)}),400);var r={};for(var a in i.inventory){var a=i.inventory[a];if(a.float){var o=String(a.float).substr(0,settings.fvdecimals+2);r[a.id]={float:o,seed:a.texture||-1},a.doppler&&a.doppler.name&&(r[a.id].phase=phases[a.doppler.name])}}t(r,n)},error:function(){t(null,n+1),setTimeout((function(){getInventoryDetails(e,t,n+1)}),2e3)}})}function replicateSteamResponse(e){var t={rgInventory:{},rgDescriptions:{}};for(var n in e.inventory){var i=e.inventory[n];t.rgInventory[n]={id:n,classid:i.classid,instanceid:i.instanceid},t.rgDescriptions[n+"_"+i.instanceid]=i}return t}function makeAPICall(e,t,n){function i(i){t.key=i,$.ajax({url:e,data:t,success:function(e){n({err:!1,data:e})},error:function(){n({err:!0})}})}getAPIKey(i)}function getSteamID(e,t,n){injectScriptWithEvent({'"%%steamID%%"':e?"g_steamID":n?"g_ulTradePartnerSteamID":"UserYou.strSteamId"},(function(){window.dispatchEvent(new CustomEvent("%%event%%",{detail:"%%steamID%%"}))}),t)}function addItemToTrade(e){injectScript({'"%%rgItem%%"':'jQuery("#'+e+'")[0].rgItem'},(function(){FindSlotAndSetItem("%%rgItem%%")}))}function removeItemFromTrade(e){injectScript({'"%%rgItem%%"':'jQuery("#'+e+'")[0].rgItem'},(function(){RevertItem("%%rgItem%%")}))}function editActionMenu(e,t){injectScript({"%%steamID%%":t,"%%steamID%%":t},(function(){$J(".itemHolder:not(.trade_slot)").each((function(){if(1!=$J(this).children().length){var e=$J(this)[0].rgItem;if(e&&e.actions){if(e.actions.some((function(e){return"View on Exchange..."===e.name||"View on Metjm..."===e.name})))return;$J(this)[0].rgItem.actions.push({link:"https://csgo.exchange/item/"+e.id,name:"View on Exchange..."});var t=e.actions[0].link.replace("%owner_steamid%","%%steamID%%").replace("%assetid%",e.id);t.indexOf("%20")>-1&&(t=t.split("%20")[1]),$J(this)[0].rgItem.actions.push({link:"https://metjm.net/csgo/#"+t,name:"View on Metjm..."})}}})),$J(".slot_inner .item.app730:not(.pendingItem)").each((function(){var e=$J(this)[0].rgItem;if(e&&e.actions){if(e.actions.some((function(e){return"View on Exchange..."===e.name||"View on Metjm..."===e.name})))return;$J(this)[0].rgItem.actions.push({link:"https://csgo.exchange/item/"+e.id,name:"View on Exchange..."});var t=e.actions[0].link.replace("%owner_steamid%","%%steamID%%").replace("%assetid%",e.id);t.indexOf("%20")>-1&&(t=t.split("%20")[1]),$J(this)[0].rgItem.actions.push({link:"https://metjm.net//csgo/#"+t,name:"View on Metjm..."})}}))}))}function injectScript(e,t){t=t.toString();for(var n in e)t=t.replace(n,e[n]);var i=document.createElement("script");i.textContent="("+t+")();",document.body.appendChild(i),i.parentNode.removeChild(i)}function injectScriptWithEvent(e,t,n){var i=String(Math.floor(1e4*Math.random()));t=t.toString().replace("%%event%%",i);for(var r in e)t=t.replace(r,e[r]);$(window).on(i,(function(e){n(e.originalEvent.detail)}));var a=document.createElement("script");a.textContent="("+t+")();",document.body.appendChild(a),a.parentNode.removeChild(a)}function stickerPriceCallback(e){if(e){var t=$("#"+e).find("#sticker_info");if(void 0!=t.html()){var n=0,i=t.text().split(": ")[1].split(", ").map((function(e){var t=prices["Sticker | "+e];return n+=Number(t),"<br>"+e+" "+formatPrice(t)}));i.push("<hr>Total: "+formatPrice(n)),t.html(t.html().replace(t.text(),i.join("")))}}}function stickerPriceInjection(){var e=BuildHover.toString();e=e.slice(e.indexOf("{")+1,e.lastIndexOf("}")),e+="window.dispatchEvent(new CustomEvent('%%event%%', {detail: elDescriptors.id}));",BuildHover=new Function("prefix","item","owner",e)}function preventScrollIntoView(){injectScript(null,(function(){shouldScroll=!1;var e=ScrollToIfNotInView.toString();e=e.slice(e.indexOf("{")+1,e.lastIndexOf("}")),e="if(!shouldScroll) return shouldScroll = true;"+e,ScrollToIfNotInView=new Function("elem","nRequiredPixelsToShow","nSpacingBefore","nAnimationSpeed",e)}))}function getCookie(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}function toSteam64(e){return new UINT64(e,17825793).toString()}var path=window.location.pathname.split("/");("/"!==path.join("/")&&["tradeoffer"].indexOf(path[1])==-1||["chat"].indexOf(path[2])>-1&&["tradingcards"].indexOf(path[1])==-1&&path.join("/").indexOf("/json/")==-1)&&($("body, .profile_header_bg_texture").css("background",'url("http://store.akamai.steamstatic.com/public/images/v6/colored_body_top.png?v=2") center top no-repeat #1b2838'),$(".profile_small_header_texture").css({"background-image":"inherit","background-color":"rgba(26,41,58,0.75)","box-shadow":"0px 0px 15px -2px black"}),$(".profile_small_header_bg").css("background-image","inherit")),["allcomments","groups","home"].indexOf(path[3])>-1&&$("#BG_bottom").css({"background-image":"inherit","background-color":"rgba(26,41,58,0.75)"});var prices={};chrome.runtime.sendMessage({action:"requestPrices"},(function(e){prices=e}));var settings={};chrome.runtime.sendMessage({action:"getSettings"},(function(e){settings=e}));var rates={};chrome.runtime.sendMessage({action:"getRates"},(function(e){rates=e}));var idPairs={},phases={Sapphire:"Sphr",Ruby:"Ruby","Phase 1":"P1","Phase 2":"P2","Phase 3":"P3","Phase 4":"P4",Emerald:"Emrl","Black Pearl":"BP"};