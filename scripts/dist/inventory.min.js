function inventoryProcess(){inventory.loaded=!0,$("#active_inventory_page").before('<h4 class="st-log-box"><span id="st-load-prices" class="st-log-msg">Loading prices...</span><span id="st-load-floats" class="st-log-msg">Loading Floats: attempt #0</span></h4>'),getSteamID(!1,(function(e){function t(t){parseInventory(t.steamID,replicateSteamResponse(t),(function(s,a){inventory.infoPairs=s,setupItems(t.ids,s,a,t.totalItems),0==Object.keys(inventory.details).length?getInventoryDetails(e,n,0):i()}))}function n(e,t){if(!e)return $("#st-load-floats").text("Loading Floats: attempt #"+t);$("#st-load-floats").text("Loaded Floats Successfully").hide().fadeIn(),inventory.details=e,i()}function i(){if(0==Object.keys(inventory.infoPairs).length||"none"!=$("#pending_inventory_page").css("display"))return setTimeout(i,500);$(".itemHolder:not(.disabled)").each((function(){if(!$(this).data("st-float-loaded")&&$(this).find(".item.app730.context2:not(.pendingItem)").attr("id")){var e=$(this).find(".item.app730.context2:not(.pendingItem)").attr("id").split("730_2_")[1];if(!inventory.details[e])return $(this).children().eq(0).data("st-float",-1);var t=inventory.details[e].float;$(this).children().eq(0).data("st-float",t),inventory.details[e].phase&&(t+=" "+inventory.details[e].phase),inventory.details[e].seed&&(t+=formatPattern(inventory.infoPairs[e].name,inventory.details[e].seed)),$(this).find(".slot_app_fraudwarning").css("margin-top","15px"),$(this).append('<span style="font-size: '+settings.fontsizetop+'px" class="st-item-float">'+t+"</span>"),$(this).data("st-float-loaded",!0)}})),void 0==$("#st-sort-inventory-float")[0]&&($("#st-sort-inventory-price").after('<a id="st-sort-inventory-float" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn"style="margin-left: 5px"><span>Sort by float</span></a>'),$("#st-sort-inventory-float").click(sortInventory.bind(null,!1)))}getInventoryDetails(e,n,0),getActiveInventory(t)}))}function sortInventory(e){window.location.hash.substr(1).length>0&&"730"!==window.location.hash.substr(1)||(expandInventory(),$(".itemHolder").has(".item.app730.context2:not(.pendingItem)").sort((function(t,n){var i=$(t).children().eq(0).data(e?"st-price":"st-float"),s=$(n).children().eq(0).data(e?"st-price":"st-float");return i==-1&&(i=inventory.sortAsc?e?9999999:1:0),s==-1&&(s=inventory.sortAsc?e?9999999:1:0),inventory.sortAsc?i-s:s-i})).appendTo(".inventory_page:nth-child(1)"),inventory.sortAsc=!inventory.sortAsc)}function expandInventory(){window.location.hash.substr(1).length>0&&"730"!==window.location.hash.substr(1)||($("#st-expand-inventory").addClass("btn_disabled"),$(".inventory_page").each((function(){$(this).css("display","")})),$(".item.app730.context2:not(.pendingItem)").each((function(){$(this).find("img:not(.st-item-sticker)").remove();var e=$(this).attr("id").split("730_2_")[1],t=inventory.infoPairs[e].img;$(this).append('<img style="position:absolute" src="https://steamcommunity-a.akamaihd.net//economy/image/'+t+'/96fx96f"/>')})),$("#inventory_pagecontrols").css("visibility","hidden"),$(".itemHolder.disabled").each((function(){$(this).remove()})),$(".trade_item_box").css("background-color","#1F1F1F").css("border","0"))}function setupItems(e,t,n,i){if(0==Object.keys(prices).length||"block"==$("#pending_inventory_page").css("display"))return setTimeout(setupItems.bind(null,t,n),500);for(var s in e){var a="#"+e[s],o=t[s];if(!$(a).data("st-loaded")){o.price&&(inventory.total+=o.price,$(a).append('<span style="font-size: '+settings.fontsizebottom+'px" class="st-item-price">'+formatPrice(o.price)+"</span>")),$(a).data("st-price",o.price||-1),$(a).append('<span style="font-size: '+settings.fontsizebottom+'px" class="st-item-wear">'+o.wear+"</span>"),o.tradable||$(a).append('<div class="st-item-not-tradable"></div>');for(var r=0;r<o.stickers.length;r++)$(a).append('<div><img class="st-item-sticker" src="'+o.stickers[r]+'" style="margin-left: '+25*r+'%"></div>');$(a).data("st-loaded",!0),$(a).attr("st-loaded",!0)}}$("#st-load-prices").fadeOut((function(){$(this).text("Inventory: "+Object.keys(t).length+" items worth "+formatPrice(inventory.total)+"!").fadeIn()})),Object.keys(t).length==i&&($("#st-load-prices").parent().before('<a id="st-expand-inventory" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn"style="margin-left: 17px"><span>Expand Inventory</span></a><a id="st-sort-inventory-price" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn"style="margin-left: 5px"><span>Sort by price</span></a>'),$("#st-expand-inventory").click(expandInventory),$("#st-sort-inventory-price").click((function(){sortInventory(!0)})),$(".st-trade-offer-prices, .st-item-price, .st-item-float").hide().fadeIn())}function isInventoryActive(e,t){injectScriptWithEvent(null,(function(){window.dispatchEvent(new CustomEvent("%%event%%",{detail:g_ActiveInventory.appid}))}),t)}function getActiveInventory(e){injectScriptWithEvent({},(function(){window.getInventory=function(e,t){for(var n={},i={},s=e;s<g_ActiveInventory.m_rgItemElements.length&&s<t;s++){var a=g_ActiveInventory.m_rgItemElements[s];if(void 0!=a){if(void 0===a[0]||!a[0].hasOwnProperty("rgItem"))return setTimeout(window.getInventory.bind(null,e,t),200);a=a[0].rgItem,$J(a.element.id).attr("st-loaded")||(n[a.assetid]=a.description,i[a.assetid]=a.element.id)}}window.dispatchEvent(new CustomEvent("%%event%%",{detail:{ids:i,inventory:n,steamID:g_ActiveInventory.m_owner.strSteamId,totalItems:g_ActiveInventory.m_rgItemElements.length}}))};var e=setInterval((function(){null!==g_ActiveInventory.rgItemElements&&(clearInterval(e),window.getInventory(0,75))}),50),t=CInventory.prototype.EnsurePageItemsCreated.toString();t=t.slice(t.indexOf("{")+1,t.lastIndexOf("}")),t+=";window.getInventory(iStart, iEnd);",CInventory.prototype.EnsurePageItemsCreated=new Function("iPage",t)}),e)}var inventory={infoPairs:{},details:{},sortAsc:!1,total:0,loaded:!1};setInterval(isInventoryActive.bind(null,730,(function(e){e?inventory.loaded||inventoryProcess():$(".st-log-box, #st-sort-inventory-float, #st-sort-inventory-price, #st-expand-inventory").remove()})),1e3),getSteamID(!1,(function(e){checkVerification(e,(function(e){e.success&&e.verified&&($(".profile_small_header_text").before('<div class="st-verified-profile st-verified-inv-page">'+e.name+"</div>"),$(".profile_small_header_text").css("bottom","25px"))}))})),injectScriptWithEvent({},stickerPriceInjection,stickerPriceCallback),injectScript({},(function(){window.PopulateMarketActions=function(e,t){if(e.update(""),!t.description.marketable||t.is_currency&&CurrencyIsWalletFunds(t))return e.hide();var n="undefined"!=typeof g_bIsTrading&&g_bIsTrading;if(!("undefined"!=typeof g_bViewingOwnProfile&&g_bViewingOwnProfile||n))return e.hide();var i=GetMarketHashName(t.description),s=new Element("div"),a=new Element("div",{style:"height: 24px;"}),o=new Element("a",{href:"https://steamcommunity.com/market/listings/"+t.appid+"/"+encodeURIComponent(i)});o.update("View in Community Market"),n&&Steam.LinkInNewWindow($J(o)),a.appendChild(o),s.appendChild(a);var r=new Element("div",{style:"min-height: 3em; margin-left: 1em;"});if(r.update('<img src="https://steamcommunity-a.akamaihd.net/public/images/login/throbber.gif" alt="Working...">'),s.appendChild(r),new Ajax.Request("https://steamcommunity.com/market/priceoverview/",{method:"get",parameters:{country:g_strCountryCode,currency:"undefined"!=typeof g_rgWalletInfo?g_rgWalletInfo.wallet_currency:1,appid:t.appid,market_hash_name:i},onSuccess:function(t){if(t.responseJSON&&t.responseJSON.success){var i="";if(t.responseJSON.lowest_price){if(i+="Starting at: "+t.responseJSON.lowest_price+"<br>",!n){var s=GetPriceValueAsInt(t.responseJSON.lowest_price)-1,a=v_currencyformat(s,GetCurrencyCode(g_rgWalletInfo.wallet_currency),g_strCountryCode),o=CreateMarketActionButton("green","javascript:false","Quick Sell "+a);$J(o).click((function(){var e=void 0===g_ActiveInventory.selectedItem.market_fee?g_rgWalletInfo.wallet_publisher_fee_percent_default:g_ActiveInventory.selectedItem.market_fee,t=s-CalculateFeeAmount(s,e).fees,n=$J(g_ActiveInventory.selectedItem.element);n.append('<div class="st-item-quick-sold"><img class="st-item-quick-selling" src="https://steamcommunity-a.akamaihd.net/public/images/login/throbber.gif"></div>').hide().fadeIn(),$J.ajax({url:"https://steamcommunity.com/market/sellitem/",type:"POST",data:{sessionid:g_sessionID,appid:g_ActiveInventory.selectedItem.appid,contextid:g_ActiveInventory.selectedItem.contextid,assetid:g_ActiveInventory.selectedItem.assetid,amount:1,price:t},crossDomain:!0,xhrFields:{withCredentials:!0}}).done((function(e){e.needs_mobile_confirmation||'In order to list this item on the Community Market, you must complete an additional verification step.  An email has been sent to your address (ending in "%s") with additional instructions.'.replace(/%s/,e.email_domain),n.find(".st-item-quick-selling").fadeOut()})).fail((function(e){var t=JSON.parse(e.responseText);ShowAlertDialog("An error occurred",t&&t.hasOwnProperty("message")?t.message:"There was a problem listing your item. Refresh the page and try again."),n.find(".st-item-quick-sold").fadeOut()}))})),e.appendChild($J(o).css("margin-left","10px")[0])}}else i+="There are no listings currently available for this item.<br>";t.responseJSON.volume&&(i+="Volume: "+"%1$s sold in the last 24 hours".replace("%1$s",t.responseJSON.volume)+"<br>"),r.update(i)}},onFailure:function(e){s.hide()}}),e.appendChild(s),!n){var l=CreateMarketActionButton("green","javascript:SellCurrentSelection()","Sell");e.appendChild(l)}if(!g_bMarketAllowed){var d=$("market_tip_noaccess");InstallHoverTooltip(l,d)}e.show()}}));