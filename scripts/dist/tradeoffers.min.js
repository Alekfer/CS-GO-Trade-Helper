function populateDetails(e,t){var i=e?myInventory:theirInventory,r=$(t).data("economy-item").split("/")[2];if(i.details[r]){var s=i.details[r].float;i.details[r].phase&&(s+=" "+i.details[r].phase),i.details[r].seed&&i.infoPairs[r]&&(s+=formatPattern(i.infoPairs[r].name,i.details[r].seed)),$(t).find(".slot_app_fraudwarning").css("margin-top","15px"),$(t).append('<span style="font-size: '+settings.fontsizetop+'px" class="st-item-float">'+s+"</span>")}}function setupOffers(){$(".tradeoffer_items_ctn").each((function(e){$(this).parent().find(".tradeoffer_footer_actions").prepend('<div class="st-trade-offer-button"><a id="st-check-offer-'+e+'" class="whiteLink">Show Prices</a> | </div>'),$(this).data("st-loaded-prices",!1),$("#st-check-offer-"+e).click((function(){$(".tradeoffer_items_ctn").eq(e).data("st-loaded-prices")||(loadPricesForOffer(e),$(".tradeoffer_items_ctn").eq(e).data("st-loaded-prices",!0))}))})),$(".st-trade-offer-button").hide().fadeIn()}function loadPricesForOffer(e){var t=$(".tradeoffer_items_ctn:eq("+e+")");sentScreen&&t.css({"-webkit-transition":"background 1s","-moz-transition":"background 1s","-o-transition":"background 1s",transition:"background 1s","background-color":"rgba(255, 255, 255, 0.1)"}),$("#st-check-offer-"+e).html('Loading Floats: attempt #<span id="st-load-floats-'+e+'">0</span>').hide().fadeIn();var i=toSteam64(t.find(".tradeoffer_items."+theirOfferClass+" .tradeoffer_avatar").data("miniprofile"));checkVerification(i,(function(e){e.success&&e.verified&&(sentScreen?$(t).parent().find(".tradeoffer_header").append('<div class="btn_grey_grey btn_medium st-verified-trade-outer"><span class="st-verified-trade-inner">'+e.name+"</span></div>"):$(t).parent().find(".tradeoffer_partner").before('<div style="margin-right: 10px" class="btn_grey_grey btn_medium st-verified-trade-outer"><span class="st-verified-trade-inner">'+e.name+"</span></div>"))})),getInventoryDetails(i,(function(t,i){if(!t)return $("#st-load-floats-"+e).text(i).hide().fadeIn(250);$("#st-check-offer-"+e).text("Loaded Floats Successfully").hide().fadeIn(),theirInventory.details=t,$(".tradeoffer_items_ctn:eq("+e+") .tradeoffer_items."+theirOfferClass+" .tradeoffer_item_list .trade_item").each((function(){populateDetails(!1,this)}))}),0);t.parent().find(".tradeoffer_partner a").attr("href");getInventory(i,(function(i,r,s){if(i)return t.find(".tradeoffer_items."+theirOfferClass+" .tradeoffer_item_list").after('<div class="st-trade-offer-prices"><div class="st-trade-offer-items-warning">Warning! Unable to load either our inventory or our partner\'s inventory.</div></div>');theirInventory.infoPairs=r;var a={mine:{items:0,total:0,types:{}},partner:{items:0,total:0,types:{}}},n=!1;$(".tradeoffer_items_ctn:eq("+e+") .tradeoffer_items .tradeoffer_item_list .trade_item").each((function(){$(this).css("box-shadow","inset 0px 0px 10px -1px black");var e=$(this).data("economy-item").split("/"),t=e[2],i="730"==e[0]?r[t]:s[t+"_"+e[3]];if(!i&&"classinfo"===e[0]){n=!0;for(var f in s)f.split("_")[0]==t&&(i=s[f])}if(i)a.partner.items+=1,a.partner.total+=i.price?i.price:0,a.partner.types[i.type]?a.partner.types[i.type]+=1:a.partner.types[i.type]=1;else{if("classinfo"===e[0])return;if(!(i=myInventory.infoPairs[t]))return;a.mine.items+=1,a.mine.total+=i.price?i.price:0,a.mine.types[i.type]?a.mine.types[i.type]+=1:a.mine.types[i.type]=1}$(this).parent().parent().hasClass("secondary")&&($(this).css("height","96px"),$(this).css("width","96px"),$(this).find("img").remove(),$(this).prepend('<img src="https://steamcommunity-a.akamaihd.net/economy/image/'+i.img+'/96fx96f"/>').hide().fadeIn()),$(this).data("st-price",i.price||0),i.price?$(this).append('<span style="font-size: '+settings.fontsizebottom+'px" class="st-item-price">'+formatPrice(i.price)+"</span>"):$(this).append('<div class="st-item-no-price"></div>'),$(this).append('<span style="font-size: '+settings.fontsizebottom+'px" class="st-item-wear">'+i.wear+"</span>");for(var o=0;o<i.stickers.length;o++)$(this).append('<img class="st-item-sticker" src="'+i.stickers[o]+'" style="margin-left: '+25*o+'%">')})),t.find(".tradeoffer_items."+theirOfferClass+" .tradeoffer_item_list .trade_item").sort((function(e,t){return $(t).data("st-price")-$(e).data("st-price")})).prependTo(t.find(".tradeoffer_items."+theirOfferClass+" .tradeoffer_item_list")),t.find(".tradeoffer_items."+myOfferClass+" .tradeoffer_item_list .trade_item").sort((function(e,t){return $(t).data("st-price")-$(e).data("st-price")})).prependTo(t.find(".tradeoffer_items."+myOfferClass+" .tradeoffer_item_list")),t.find(".tradeoffer_items."+theirOfferClass+" .tradeoffer_item_list").after('<div class="st-trade-offer-prices">'+formatPrice(a.partner.total)+'<div class="st-display-right">'+a.partner.items+" "+(1==a.partner.items?"item":"items")+"</div>"+buildItemSummary(a.partner.types)+"</div>"),t.find(".tradeoffer_items."+myOfferClass+" .tradeoffer_item_list").after('<div class="st-trade-offer-prices">'+formatPrice(a.mine.total)+'<div class="st-display-right">'+a.mine.items+" "+(1==a.mine.items?"item":"items")+"</div>"+buildItemSummary(a.mine.types)+"</div>"),n||0==a.partner.items&&0==a.mine.items?isOfferGlitched(t.parent().attr("id").split("_")[1],(function(e){e&&t.find(".tradeoffer_items."+myOfferClass+" .st-trade-offer-prices").append('<hr class="st-trade-offer-divider"><div class="st-trade-offer-items-glitched">Note: this appears to be a glitched offer</div>')})):(0==a.partner.items&&t.find(".tradeoffer_items."+theirOfferClass+" .st-trade-offer-prices").append('<hr class="st-trade-offer-divider"><div class="st-trade-offer-items-warning">Warning! You will not receive any items in this trade.</div>'),0==a.mine.items&&t.find(".tradeoffer_items."+myOfferClass+" .st-trade-offer-prices").append('<hr class="st-trade-offer-divider"><div class="st-trade-offer-items-awesome">Awesome! You\'re getting free items!</div>')),Object.keys(myInventory.details).length>0&&t.find(".tradeoffer_items."+myOfferClass+" .tradeoffer_item_list .trade_item").each((function(){populateDetails(!0,this)})),t.find(".st-trade-offer-prices, .st-item-price, .st-item-no-price, .st-item-float").hide().fadeIn()}))}$(".profile_leftcol").prepend('<h4 class="st-loading-details"><span id="st-load-my-inv">Loading inventory...</span><span id="st-load-my-floats"> | Loading Floats: attempt #0</span></h4><hr class="st-trade-offer-divider">').hide().fadeIn(),$(".maincontent").css("background-color","rgba(38, 38, 39, 0.65)");var sentScreen=window.location.pathname.split("/").indexOf("sent")>-1,myOfferClass=sentScreen?"primary":"secondary",theirOfferClass=sentScreen?"secondary":"primary",myInventory={infoPairs:{},details:{}},theirInventory={infoPairs:{},details:{}};getSteamID(!0,(function(e){getInventory(e,(function(e,t,i){if(e)return $("#st-load-my-floats").hide(),$("#st-load-my-inv").text("Error loading inventory").hide().fadeIn();$("#st-load-my-inv").text("Loaded inventory!").hide().fadeIn(),myInventory.infoPairs=t,setupOffers()}))}),!1),getSteamID(!0,(function(e){getInventoryDetails(e,(function(e,t){function i(){if(0==Object.keys(myInventory.infoPairs).length)return setTimeout(i,500);$(".tradeoffer_items_ctn").each((function(e){$(this).data("st-loaded-prices")&&($(this).find(".tradeoffer_items."+myOfferClass+" .tradeoffer_item_list .trade_item").each((function(){populateDetails(!0,this)})),$(".st-item-float").hide().fadeIn())}))}if(!e)return $("#st-load-my-floats").text(" | Loading Floats: attempt #"+t);$("#st-load-my-floats").text(" | Loaded Floats Successfully"),myInventory.details=e,i()}),0)}),!0),injectScriptWithEvent({},stickerPriceInjection,stickerPriceCallback);